<div class="checkout shadow-lg">
  <div class="credit-card-box" [class.active]="cvvFocus" >
    <div class="flip">
      <div class="front d-flex flex-column justify-content-between">
        <!-- for logo and chip -->
        <div>
          <div class="chip"></div>
          <div class="logo">
            <svg version="1.1" id="visa" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 width="47.834px" height="47.834px" viewBox="0 0 47.834 47.834" style="enable-background:new 0 0 47.834 47.834;">
              <g>
                <g>
                  <path d="M44.688,16.814h-3.004c-0.933,0-1.627,0.254-2.037,1.184l-5.773,13.074h4.083c0,0,0.666-1.758,0.817-2.143
                           c0.447,0,4.414,0.006,4.979,0.006c0.116,0.498,0.474,2.137,0.474,2.137h3.607L44.688,16.814z M39.893,26.01
                           c0.32-0.819,1.549-3.987,1.549-3.987c-0.021,0.039,0.317-0.825,0.518-1.362l0.262,1.23c0,0,0.745,3.406,0.901,4.119H39.893z
                           M34.146,26.404c-0.028,2.963-2.684,4.875-6.771,4.875c-1.743-0.018-3.422-0.361-4.332-0.76l0.547-3.193l0.501,0.228
                           c1.277,0.532,2.104,0.747,3.661,0.747c1.117,0,2.313-0.438,2.325-1.393c0.007-0.625-0.501-1.07-2.016-1.77
                           c-1.476-0.683-3.43-1.827-3.405-3.876c0.021-2.773,2.729-4.708,6.571-4.708c1.506,0,2.713,0.31,3.483,0.599l-0.526,3.092
                           l-0.351-0.165c-0.716-0.288-1.638-0.566-2.91-0.546c-1.522,0-2.228,0.634-2.228,1.227c-0.008,0.668,0.824,1.108,2.184,1.77
                           C33.126,23.546,34.163,24.783,34.146,26.404z M0,16.962l0.05-0.286h6.028c0.813,0.031,1.468,0.29,1.694,1.159l1.311,6.304
                           C7.795,20.842,4.691,18.099,0,16.962z M17.581,16.812l-6.123,14.239l-4.114,0.007L3.862,19.161
                           c2.503,1.602,4.635,4.144,5.386,5.914l0.406,1.469l3.808-9.729L17.581,16.812L17.581,16.812z M19.153,16.8h3.89L20.61,31.066
                           h-3.888L19.153,16.8z"/>
                </g>
              </g>
            </svg>
          </div>
        </div>
        <div class="card-number d-flex flex-column justify-content-center align-items-center">
          <label>Card Number</label>
          <div>
            {{ cardNumber[0] }} {{ cardNumber[1] }} {{ cardNumber[2] }} {{ cardNumber[3] }}
          </div>
          </div>
        <div>
          <div class="card-holder" >
            <label>Card holder</label>
            <div>
              {{ cardholderName }}
            </div>
          </div>
          <div class="card-expiration-date">
            <label>Expires</label>
            <div>{{ expirationDatemonth }}/{{expirationDateyear}} </div>
          </div>
        </div>
      </div>

      <div class="back d-flex flex-column justify-content-between">
        <div class="strip"></div>
        <div>
        <div class="logo">
          <svg version="1.1" id="visa" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
               width="47.834px" height="47.834px" viewBox="0 0 47.834 47.834" style="enable-background:new 0 0 47.834 47.834;">
            <g>
              <g>
                <path d="M44.688,16.814h-3.004c-0.933,0-1.627,0.254-2.037,1.184l-5.773,13.074h4.083c0,0,0.666-1.758,0.817-2.143
                         c0.447,0,4.414,0.006,4.979,0.006c0.116,0.498,0.474,2.137,0.474,2.137h3.607L44.688,16.814z M39.893,26.01
                         c0.32-0.819,1.549-3.987,1.549-3.987c-0.021,0.039,0.317-0.825,0.518-1.362l0.262,1.23c0,0,0.745,3.406,0.901,4.119H39.893z
                         M34.146,26.404c-0.028,2.963-2.684,4.875-6.771,4.875c-1.743-0.018-3.422-0.361-4.332-0.76l0.547-3.193l0.501,0.228
                         c1.277,0.532,2.104,0.747,3.661,0.747c1.117,0,2.313-0.438,2.325-1.393c0.007-0.625-0.501-1.07-2.016-1.77
                         c-1.476-0.683-3.43-1.827-3.405-3.876c0.021-2.773,2.729-4.708,6.571-4.708c1.506,0,2.713,0.31,3.483,0.599l-0.526,3.092
                         l-0.351-0.165c-0.716-0.288-1.638-0.566-2.91-0.546c-1.522,0-2.228,0.634-2.228,1.227c-0.008,0.668,0.824,1.108,2.184,1.77
                         C33.126,23.546,34.163,24.783,34.146,26.404z M0,16.962l0.05-0.286h6.028c0.813,0.031,1.468,0.29,1.694,1.159l1.311,6.304
                         C7.795,20.842,4.691,18.099,0,16.962z M17.581,16.812l-6.123,14.239l-4.114,0.007L3.862,19.161
                         c2.503,1.602,4.635,4.144,5.386,5.914l0.406,1.469l3.808-9.729L17.581,16.812L17.581,16.812z M19.153,16.8h3.89L20.61,31.066
                         h-3.888L19.153,16.8z"/>
              </g>
            </g>
          </svg>
        </div>
        </div>
        <div class="ccv d-flex justify-content-between">
          {{ cardholderName }}
          <div>
            <div>{{ cvv }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <form (ngSubmit)="onFormSubmit()" [formGroup]="creditcardForm">
    <div class="mb-3">
      <label>Name on Card</label>
      <input
          formControlName="name" class="form-control" type="text"
          placeholder="John Smith"
          (input)="onNameChange($event)">
      <div *ngIf="creditcardForm.get('name')?.invalid && creditcardForm.get('name')?.touched" class="text-danger">
        <div *ngIf="creditcardForm.get('name')?.errors?.['required']">
          Name on Card is required.
        </div>
        <div *ngIf="creditcardForm.get('name')?.errors?.['minlength']">
          Name on Card must be at least 6 characters long.
        </div>
        <div *ngIf="creditcardForm.get('name')?.errors?.['pattern']">
          You must enter your name similar to your name appears on your card.
        </div>
      </div>
    </div>


    <div class="mb-3">
      <label>Card Number</label>
      <input formControlName="cardNumber" class="form-control" type="text"
       maxlength="16" placeholder="XXXXXXXXXXXXXXXX"
       (input)="onCardNumberChange($event)">
      <div *ngIf="creditcardForm.get('cardNumber')?.invalid && creditcardForm.get('cardNumber')?.touched"
          class="text-danger">
        <div *ngIf="creditcardForm.get('cardNumber')?.errors?.['required']">
          CardNumber is required
        </div>
        <div *ngIf="creditcardForm.get('cardNumber')?.errors?.['pattern']">
          CardNumber must be 16 digits.
        </div>
      </div>

      <!-- <input class="form-control" type="text"  maxlength="16"
      placeholder="XXXXXXXXXXXXXXXX" [(ngModel)]="cardNumber"
      (input)="onCardNumberChange($event)"> -->

    </div>

    <div class="d-flex gap-3 mb-2 col-sm-12">
      <div class="d-flex flex-column">
      <label>Expiration Date</label>
      <div class="d-flex">
        <div class="col-sm-12 col-md-6">
          <div class="select">
            <select class="form-control" formControlName="expirationMonth"
            (input)="onexpirationDatemonthChange($event)">
              <option value="" disabled selected>Month</option>
              <option *ngFor="let month of filteredMonths" [value]="month">{{ month }}</option>
            </select>
          </div>
          <div *ngIf="creditcardForm.get('expirationMonth')?.invalid && creditcardForm.get('expirationMonth')?.touched"
            class="text-danger">Please select a month.</div>
        </div>

        <div class="col-sm-12 col-md-6">
          <div class="select">
            <select class="form-control" formControlName="expirationYear"
              (input)="onexpirationDateyearChange($event)">
                <option value="" disabled selected> Year</option>
                <option *ngFor="let year of years" [value]="year">{{ year }}</option>
            </select>
          </div>
          <div *ngIf="creditcardForm.get('expirationYear')?.invalid && creditcardForm.get('expirationYear')?.touched"
            class="text-danger">Please select a year.</div>
        </div>
      </div>

    </div>

    <div class="col-sm-12 col-md-6">
      <label>CVV</label>
      <input class="form-control cvvinput" type="text"
              maxlength="3"placeholder="XXX" formControlName="cvv"
              (focus)="onCvvFocus()" (blur)="onCvvBlur()"
            (input)="onCvvChange($event)">
            <div *ngIf="creditcardForm.get('cvv')?.invalid && creditcardForm.get('cvv')?.touched"
                class="text-danger">
              <div *ngIf="creditcardForm.get('cvv')?.errors?.['required']">
                CVV is required
              </div>
              <div *ngIf="creditcardForm.get('cvv')?.errors?.['pattern']">
                CVV must be three digit.
              </div>
            </div>
    </div>
  </div>

    <section class="summary rounded shadow-lg mt-3 fs-5 mb-3 d-flex justify-content-around">
      <div class="items">ðŸ›’ {{cart.length}} items</div>
      <div class="total">Price: {{cartTotalPrice.toFixed(2)}}ðŸ’²</div>
    </section>
    <button class="btn col-12 mt-3 pay" type="submit">Pay</button>
  </form>
</div>
